// Add a claim for the issue time.
            new Claim(JwtRegisteredClaimNames.Iat, DateTimeOffset.UtcNow.ToUnixTimeSeconds().ToString(), ClaimValueTypes.Integer64)













private void AttachUserToContext(HttpContext context, string token)
{
   try
   {
       ...
       SecurityToken validatedToken;

       JwtSecurityTokenHandler handler=new JwtSecurityTokenHandler();
       
       handler.ValidateToken(token, validationParameters,out validated Token);
      
      // Calculate expiration moment based on 'iat' claim 
      long iatRaw=long.Parse(validated Token.Claims.First(c => c.Type == "iat").Value);
      DateTimeOffset dtIssued=DateTimeOffset.FromUnixTimeSeconds(iatRaw).UtcDateTime;
   
      // Check whether current UTC time exceeds calculated moment by more than 15 min 
      if (dtIssued.AddMinutes(15) < DateTime.UtcNow) 
          throw Exception("Expired Token");
          
        ...
}
catch(Exception e)
{...}
